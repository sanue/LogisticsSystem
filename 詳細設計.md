# **物流管理システム 次世代システム再構築 詳細設計書**

**版数:** 1.0
**作成日:** 2025年9月4日
**作成者:** \[社名]
**確認者:** \[クライアント先担当者名]

---

## 1. 概要

本詳細設計書は、要件定義書（版1.1）を基に、次世代物流管理システムの具体的な設計内容を定義する。設計対象は以下のサブシステムとする。

* 入荷・検品管理
* 在庫管理
* 出荷指示・ピッキング管理
* 生産計画連携
* マスタデータ管理

非対象範囲は要件定義書に準拠。

---

## 2. アーキテクチャ設計

### 2.1. システム構成

```
[ブラウザ] <--HTTP(S)--> [Webサーバ / Spring Boot API] <--JDBC--> [Oracle DB]
                            |--> [バッチジョブスケジューラ]
                            |--> [外部システム連携モジュール]
```

* **フロントエンド:** React + TypeScript
* **バックエンド:** Spring Boot (Java 17), RESTful API
* **DB:** Oracle 19c
* **バッチ:** Spring Batch + Quartz Scheduler
* **認証:** JWT + LDAP連携
* **監査ログ:** DBテーブルに操作ログを格納

### 2.2. 外部連携方式

| 接続先      | 方式       | データ形式   | 頻度   |
| -------- | -------- | ------- | ---- |
| 生産管理システム | FTP/SFTP | CSV/XML | 毎時受信 |
| 受注管理システム | REST API | JSON    | 随時受信 |
| 基幹システム   | FTP/SFTP | CSV     | 日次送信 |

---

## 3. 画面設計

### 3.1. 入荷管理画面

| 画面名    | 機能             | 項目                   | 備考            |
| ------ | -------------- | -------------------- | ------------- |
| 入荷予定一覧 | ASNデータ取込後に一覧表示 | 商品コード、数量、入荷予定日、仕入先   | フィルタ条件：日付・仕入先 |
| 入荷実績入力 | 入荷検品結果の登録      | 商品コード、入荷数量、検品結果、差異理由 | 棚札発行ボタン付き     |
| 棚札発行画面 | 棚場所登録 & 印刷     | 商品コード、ロケーション、バーコード   | PDF出力対応       |

### 3.2. 在庫管理画面

| 画面名    | 機能        | 項目                    |
| ------ | --------- | --------------------- |
| 在庫一覧   | 現在庫数表示    | 商品コード、ロケーション、数量、安全在庫  |
| 棚卸管理   | 棚卸実施・結果登録 | 商品コード、棚卸数量、差異数量、差異理由  |
| 在庫アラート | 安全在庫以下通知  | 商品コード、ロケーション、現在庫数、発注点 |

### 3.3. 出荷管理画面

| 画面名        | 機能          | 項目                  |
| ---------- | ----------- | ------------------- |
| 出荷指示一覧     | 受注データ表示     | 顧客コード、商品コード、数量、納期   |
| ピッキングリスト作成 | 出荷効率順でリスト生成 | 商品コード、数量、ロケーション、優先度 |
| 出荷実績登録     | 出荷完了報告      | 運送会社、伝票番号、数量、出荷日時   |
| 出荷荷札発行     | ラベル印刷       | 顧客情報、商品情報、バーコード     |

### 3.4. マスタ管理画面

| 画面名   | 機能       | 項目                     |
| ----- | -------- | ---------------------- |
| 商品マスタ | 登録・更新・削除 | 商品コード、商品名、規格、単位、賞味期限情報 |
| 顧客マスタ | 登録・更新・削除 | 顧客コード、顧客名、住所、連絡先       |
| 倉庫マスタ | 登録・更新・削除 | 倉庫コード、ロケーション、最大容量      |

---

## 4. DB設計（主要テーブル）

### 4.1. 入荷管理

**入荷予定テーブル (`INCOMING_PLAN`)**

| カラム           | 型            | PK/FK | 備考       |
| ------------- | ------------ | ----- | -------- |
| PLAN\_ID      | NUMBER       | PK    | 自動採番     |
| ASN\_NO       | VARCHAR2(20) |       | 仕入先ASN番号 |
| PRODUCT\_ID   | VARCHAR2(20) | FK    | 商品マスタ    |
| PLAN\_QTY     | NUMBER       |       | 予定数量     |
| ARRIVAL\_DATE | DATE         |       | 入荷予定日    |
| STATUS        | VARCHAR2(10) |       | 未入荷/入荷済み |

**入荷実績テーブル (`INCOMING_ACTUAL`)**

| カラム                 | 型             | PK/FK | 備考             |
| ------------------- | ------------- | ----- | -------------- |
| ACTUAL\_ID          | NUMBER        | PK    | 自動採番           |
| PLAN\_ID            | NUMBER        | FK    | INCOMING\_PLAN |
| ACTUAL\_QTY         | NUMBER        |       | 実績数量           |
| DISCREPANCY\_REASON | VARCHAR2(100) |       | 差異理由           |
| RECEIVED\_AT        | TIMESTAMP     |       | 入荷日時           |

### 4.2. 在庫管理

**在庫テーブル (`INVENTORY`)**

| カラム           | 型            | PK/FK | 備考       |
| ------------- | ------------ | ----- | -------- |
| INVENTORY\_ID | NUMBER       | PK    | 自動採番     |
| PRODUCT\_ID   | VARCHAR2(20) | FK    | 商品マスタ    |
| LOCATION\_ID  | VARCHAR2(20) | FK    | 倉庫ロケーション |
| QUANTITY      | NUMBER       |       | 現在庫数     |
| SAFETY\_STOCK | NUMBER       |       | 安全在庫     |
| LAST\_UPDATED | TIMESTAMP    |       | 最終更新日時   |

### 4.3. 出荷管理

**出荷指示テーブル (`SHIPMENT_ORDER`)**

| カラム            | 型            | PK/FK | 備考      |
| -------------- | ------------ | ----- | ------- |
| ORDER\_ID      | NUMBER       | PK    | 自動採番    |
| CUSTOMER\_ID   | VARCHAR2(20) | FK    | 顧客マスタ   |
| PRODUCT\_ID    | VARCHAR2(20) | FK    | 商品マスタ   |
| ORDER\_QTY     | NUMBER       |       | 注文数量    |
| SHIPMENT\_DATE | DATE         |       | 出荷予定日   |
| STATUS         | VARCHAR2(10) |       | 未出荷/出荷済 |

**出荷実績テーブル (`SHIPMENT_ACTUAL`)**

| カラム          | 型            | PK/FK | 備考              |
| ------------ | ------------ | ----- | --------------- |
| ACTUAL\_ID   | NUMBER       | PK    | 自動採番            |
| ORDER\_ID    | NUMBER       | FK    | SHIPMENT\_ORDER |
| SHIPPED\_QTY | NUMBER       |       | 出荷数量            |
| CARRIER      | VARCHAR2(50) |       | 運送会社            |
| TRACKING\_NO | VARCHAR2(50) |       | 伝票番号            |
| SHIPPED\_AT  | TIMESTAMP    |       | 出荷日時            |

---

## 5. バッチ・処理設計

| 処理名       | 頻度    | 処理内容                          |
| --------- | ----- | ----------------------------- |
| ASN取込バッチ  | 毎時    | FTP/SFTPでASN受信 → 入荷予定作成       |
| 在庫更新バッチ   | 10分間隔 | 入荷実績・出荷実績を元に在庫テーブル更新          |
| 出荷計画作成バッチ | 随時    | 受注データ受信 → 出荷指示生成 → ピッキングリスト作成 |
| 棚卸差異集計    | 日次    | 棚卸実績から差異を集計 → レポート出力          |

---

## 6. セキュリティ設計

* **認証:** LDAP + JWT
* **権限管理:** ロールベース（管理者、倉庫担当者、出荷担当者、監査者）
* **操作ログ:** マスタ更新、データ削除、入荷・出荷実績の変更を記録
* **パスワード:** 8文字以上、英数字記号、90日で期限切れ
* **IP制限:** 倉庫ネットワークおよびVPN経由のみアクセス可

---

## 7. データ移行設計

1. **マスタデータ移行:** CSV → Oracle DB
2. **トランザクションデータ移行:** 段階的に移行し、移行前後で件数・金額・数量を照合
3. **テスト移行:** 本番前に2回リハーサル実施
4. **バックアップ:** 移行前に現行DBをフルバックアップ
5. **ロールバック手順:** 移行失敗時に旧システムに戻せる手順書作成

---

## 8. テスト設計

| テスト種類 | 内容                  | 目的             |
| ----- | ------------------- | -------------- |
| 単体テスト | 各API・バッチ処理の動作確認     | 正常系・異常系の検証     |
| 結合テスト | フロントエンド・バックエンド・DB連携 | 画面操作からDB反映まで確認 |
| 移行テスト | データ移行の検証            | データ整合性と欠損確認    |
| 総合テスト | 業務フロー全体             | 要件達成確認         |
| UAT   | 実業務担当者による操作         | 業務要件満足確認       |

---

## 9. 将来拡張設計（参考）

* 輸送管理モジュール（ルート最適化）
* 労働管理モジュール（作業分析・タスク割り当て）
* 高度在庫分析（需要予測・FEFO）
* 顧客ポータル（在庫・出荷確認）
* PDA/モバイル対応

---

この詳細設計書は、要件定義書を具体的な技術仕様に落とし込んだもので、設計・開発チームが開発フェーズで使用できるレベルに整備されています。

